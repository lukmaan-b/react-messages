{"version":3,"sources":["hooks/useLocalStorage.js","context/SocketProvider.js","context/ChatProvider.js","context/RecipientProvider.js","components/Chat.js","components/SideBar.js","components/RecipientInput.js","App.js","index.js"],"names":["useLocalStorage","key","initValue","PREFIXKEY","useState","item","window","localStorage","getItem","JSON","parse","Function","error","console","storedValue","setStoredValue","useEffect","setItem","stringify","SocketContext","React","createContext","SocketProvider","children","userId","socket","setSocket","newSocket","io","query","close","Provider","value","ChatContext","ChatProvider","useContext","log","chat","setChat","on","message","prevState","handleRecieveMessage","handleSendMessage","emit","RecipientContext","RecipientProvider","recipients","setRecipients","handleDeleteRecipient","id","filter","r","handleAddRecipient","Chat","setMessage","disabled","setDisabled","ChatListComponent","map","msg","i","className","author","style","borderRadius","wordBreak","body","length","overflow","Form","marginTop","onSubmit","e","preventDefault","InputGroup","Control","onChange","target","as","rows","Append","Button","type","SideBar","recipientComponentList","variant","onClick","paddingTop","RecipientInput","input","setInput","Group","Label","App","uuidv4","Container","fluid","Row","Col","xs","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e46cd585.chunk.js","sourcesContent":["import { useEffect, useState } from 'react';\r\n\r\nconst useLocalStorage = (key, initValue) => {\r\n  const PREFIXKEY = 'react-message-' + key;\r\n  const [storedValue, setStoredValue] = useState(() => {\r\n    try {\r\n      const item = window.localStorage.getItem(PREFIXKEY);\r\n\r\n      if (item != null) return JSON.parse(item);\r\n\r\n      if (initValue instanceof Function) return initValue();\r\n\r\n      return initValue;\r\n    } catch (error) {\r\n      console.error(error);\r\n      return initValue;\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem(PREFIXKEY, JSON.stringify(storedValue));\r\n  }, [PREFIXKEY, storedValue]);\r\n\r\n  return [storedValue, setStoredValue];\r\n};\r\n\r\nexport default useLocalStorage;\r\n","import React, { useEffect, useState } from 'react';\r\nimport io from 'socket.io-client';\r\n\r\nconst SocketContext = React.createContext();\r\nconst SocketProvider = ({ children, userId }) => {\r\n  const [socket, setSocket] = useState();\r\n\r\n  useEffect(() => {\r\n    const newSocket = io('https://message-server-react.herokuapp.com', {\r\n      query: { userId },\r\n    });\r\n    setSocket(newSocket);\r\n    return () => newSocket.close();\r\n  }, [userId]);\r\n\r\n  return (\r\n    <SocketContext.Provider value={socket}>{children}</SocketContext.Provider>\r\n  );\r\n};\r\n\r\nexport { SocketProvider, SocketContext };\r\n","import React, { useContext, useEffect } from 'react';\r\nimport useLocalStorage from '../hooks/useLocalStorage';\r\nimport { SocketContext } from './SocketProvider';\r\n\r\nconst ChatContext = React.createContext();\r\nconst ChatProvider = ({ children }) => {\r\n  const socket = useContext(SocketContext);\r\n  console.log(socket);\r\n  const [chat, setChat] = useLocalStorage('chat', []);\r\n\r\n  const handleSendMessage = (message) => {\r\n    setChat((prevState) => [...prevState, message]);\r\n    socket && socket.emit('send-message', message);\r\n  };\r\n\r\n  const handleRecieveMessage = (message) => {\r\n    setChat((prevState) => [...prevState, message]);\r\n  };\r\n\r\n  useEffect(() => {\r\n    socket &&\r\n      socket.on('message-recieve', (message) => {\r\n        handleRecieveMessage(message);\r\n      });\r\n  }, [socket]);\r\n\r\n  const value = { chat, setChat, handleSendMessage };\r\n\r\n  return <ChatContext.Provider value={value}>{children}</ChatContext.Provider>;\r\n};\r\n\r\nexport { ChatProvider, ChatContext };\r\n","import React from 'react';\r\nimport useLocalStorage from '../hooks/useLocalStorage';\r\n\r\nconst RecipientContext = React.createContext();\r\nconst RecipientProvider = ({ children }) => {\r\n  const [recipients, setRecipients] = useLocalStorage('recipients', []);\r\n\r\n  const handleDeleteRecipient = (id) => {\r\n    setRecipients((prevState) => prevState.filter((r) => r !== id));\r\n  };\r\n\r\n  const handleAddRecipient = (id) => {\r\n    setRecipients((prevState) => [...prevState, id]);\r\n  };\r\n\r\n  const value = {\r\n    recipients,\r\n    setRecipients,\r\n    handleDeleteRecipient,\r\n    handleAddRecipient,\r\n  };\r\n\r\n  return (\r\n    <RecipientContext.Provider value={value}>\r\n      {children}\r\n    </RecipientContext.Provider>\r\n  );\r\n};\r\n\r\nexport { RecipientProvider, RecipientContext };\r\n","import React, { useContext, useEffect, useState } from 'react';\r\nimport { ChatContext } from '../context/ChatProvider';\r\nimport { RecipientContext } from '../context/RecipientProvider';\r\n\r\nimport { Button, Form, InputGroup } from 'react-bootstrap';\r\n\r\nconst Chat = ({ userId }) => {\r\n  const [message, setMessage] = useState('');\r\n  const [disabled, setDisabled] = useState(true);\r\n  const { chat, handleSendMessage } = useContext(ChatContext);\r\n  const { recipients } = useContext(RecipientContext);\r\n  const ChatListComponent = chat.map((msg, i) => (\r\n    <div\r\n      key={i}\r\n      className={` bg-primary mt-3 ${\r\n        msg.author === userId\r\n          ? 'align-self-end bg-primary'\r\n          : 'align-self-start bg-success'\r\n      }`}\r\n      style={{ borderRadius: '10px' }}\r\n    >\r\n      <p\r\n        className=\"m-0 text-light pt-3 px-3\"\r\n        style={{\r\n          wordBreak: 'break-word',\r\n        }}\r\n      >\r\n        {msg.body}\r\n      </p>\r\n      <p className=\"text-light px-3 pb-1 m-0\">\r\n        <small>{msg.author}</small>\r\n      </p>\r\n    </div>\r\n  ));\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (recipients.length > 0) {\r\n      const payload = { author: userId, body: message, recipients };\r\n      handleSendMessage(payload);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    recipients.length > 0 ? setDisabled(false) : setDisabled(true);\r\n  }, [recipients]);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"d-flex flex-column \" style={{ overflow: 'auto' }}>\r\n        {ChatListComponent}\r\n      </div>\r\n      <Form style={{ marginTop: '1rem' }} onSubmit={handleSubmit}>\r\n        <InputGroup>\r\n          <Form.Control\r\n            disabled={disabled}\r\n            onChange={({ target: { value } }) => setMessage(value)}\r\n            as=\"textarea\"\r\n            rows={5}\r\n          />\r\n          <InputGroup.Append>\r\n            <Button disabled={disabled} type=\"submit\">\r\n              Enter\r\n            </Button>\r\n          </InputGroup.Append>\r\n        </InputGroup>\r\n      </Form>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Chat;\r\n","import React, { useContext } from 'react';\r\nimport { RecipientContext } from '../context/RecipientProvider';\r\nimport { Button } from 'react-bootstrap';\r\n\r\nconst SideBar = ({ userId }) => {\r\n  const { recipients, handleDeleteRecipient } = useContext(RecipientContext);\r\n  const recipientComponentList = recipients.map((r) => (\r\n    <div key={r} className=\"mt-2 d-flex flex-row-reverse\">\r\n      <Button\r\n        variant=\"danger\"\r\n        className=\"rounded-right\"\r\n        style={{ borderRadius: '0' }}\r\n        onClick={() => handleDeleteRecipient(r)}\r\n      >\r\n        X\r\n      </Button>\r\n      <span\r\n        className=\"p-1 bg-light w-100 rounded-left text-dark\"\r\n        style={{ wordBreak: 'break-word' }}\r\n      >\r\n        {r}\r\n      </span>\r\n    </div>\r\n  ));\r\n\r\n  return (\r\n    <div className=\"min-vh-100 d-flex flex-column justify-content-between border-right p-2\">\r\n      <div style={{ overflow: 'auto', paddingTop: '1rem' }}>\r\n        {recipientComponentList}\r\n      </div>\r\n      <p className=\"text-muted\">{`User ID: ${userId}`}</p>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SideBar;\r\n","import React, { useContext, useState } from 'react';\r\n\r\nimport { Button, Form, InputGroup } from 'react-bootstrap';\r\nimport { RecipientContext } from '../context/RecipientProvider';\r\n\r\nconst RecipientInput = ({ userId }) => {\r\n  const [input, setInput] = useState('');\r\n\r\n  const { handleAddRecipient } = useContext(RecipientContext);\r\n\r\n  return (\r\n    <Form\r\n      onSubmit={(e) => {\r\n        e.preventDefault();\r\n        if (input !== userId) handleAddRecipient(input);\r\n      }}\r\n    >\r\n      <Form.Group>\r\n        <Form.Label className=\"text-muted\">Recipient ID</Form.Label>\r\n        <InputGroup>\r\n          <Form.Control onChange={({ target: { value } }) => setInput(value)} />\r\n          <InputGroup.Append>\r\n            <Button type=\"submit\">+</Button>\r\n          </InputGroup.Append>\r\n        </InputGroup>\r\n      </Form.Group>\r\n    </Form>\r\n  );\r\n};\r\n\r\nexport default RecipientInput;\r\n","import { v4 as uuidv4 } from 'uuid';\nimport Chat from './components/Chat';\nimport SideBar from './components/SideBar';\nimport useLocalStorage from './hooks/useLocalStorage';\n\n// Bootstrap\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Col, Container, Row } from 'react-bootstrap';\nimport { RecipientProvider } from './context/RecipientProvider';\nimport RecipientInput from './components/RecipientInput';\nimport { ChatProvider } from './context/ChatProvider';\nimport { SocketProvider } from './context/SocketProvider';\n\nfunction App() {\n  const [userId] = useLocalStorage('userId', () => uuidv4());\n\n  return (\n    <SocketProvider userId={userId}>\n      <RecipientProvider>\n        <ChatProvider>\n          <Container fluid>\n            <Row>\n              <Col xs={4}>\n                <SideBar userId={userId} />\n              </Col>\n              <Col\n                style={{ paddingTop: '1rem' }}\n                className=\"d-flex flex-column justify-content-between min-vh-100\"\n              >\n                <RecipientInput />\n                <Chat userId={userId} />\n              </Col>\n            </Row>\n          </Container>\n        </ChatProvider>\n      </RecipientProvider>\n    </SocketProvider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}